{% extends "base.html" %}
{% block content %}

<div class="d-flex flex-wrap align-items-end justify-content-between gap-2 mb-3">
  <div>
    <div class="text-muted small">조회용</div>
    <h4 class="mb-1">사진 등록된 상품 리스트</h4>
    <div class="text-muted">상품명 / 상품코드 / 바코드로 검색하고 엑셀로 다운로드할 수 있습니다.</div>
  </div>

  <div class="d-flex gap-2">
    <a class="btn btn-primary" href="{{ url_for('view_export_products_with_photos_xlsx', q=q) }}">엑셀 다운로드</a>
  </div>
</div>

<div class="card p-3 shadow-soft mb-3">
  <form method="get">
    <div class="input-group">
      <input type="text" class="form-control" name="q" value="{{ q }}" placeholder="상품명/상품코드/바코드 검색">
      <button class="btn btn-outline-primary" type="submit">검색</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('view_products_with_photos') }}">초기화</a>
    </div>
  </form>
</div>

<div class="card shadow-soft">
  {% if rows and rows|length > 0 %}
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead>
          <tr>
            <th style="min-width:150px;">상품코드</th>
            <th>상품명</th>
            <th style="min-width:180px;">스캔바코드</th>
            <th class="text-end" style="min-width:90px;">사진수</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
          <tr>
            <td class="fw-semibold mono">{{ r['item_code'] }}</td>
            <td>{{ r['item_name'] or '-' }}</td>
            <td class="mono">{{ r['scan_code'] or '-' }}</td>
            <td class="text-end">{{ r['photo_count'] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="p-5 text-center">
      <div class="fw-semibold mb-1">표시할 데이터가 없습니다</div>
      <div class="text-muted">아직 사진이 등록된 상품이 없거나, 검색 조건에 해당하는 결과가 없습니다.</div>
    </div>
  {% endif %}
</div>

{% endblock %}
