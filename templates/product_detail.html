{% extends "base.html" %}
{% block content %}

<div class="container py-3" style="max-width: 1100px;">
  <div class="d-flex flex-wrap justify-content-between align-items-end gap-2 mb-3">
    <div>
      <div class="text-muted small">등록용</div>
      <h4 class="mb-1">{{ product['item_name'] or '-' }}</h4>
      <div class="text-muted">
        상품코드: <span class="fw-semibold">{{ product['item_code'] }}</span> |
        바코드: <span class="fw-semibold">{{ product['scan_code'] or '-' }}</span>
      </div>
    </div>

    <div class="d-flex gap-2">
      <a class="btn btn-outline-secondary" href="{{ url_for('register_home') }}">← 목록</a>
      <a class="btn btn-outline-secondary" href="{{ url_for('logout') }}">로그아웃</a>
    </div>
  </div>

  <!-- 업로드 영역 -->
  <div class="card p-3 shadow-sm mb-4">
    <form method="post" enctype="multipart/form-data">
      <div class="mb-2 fw-semibold">사진 업로드</div>
      <div class="input-group">
        <input
          type="file"
          class="form-control"
          name="photos"
          multiple
          accept="image/*"
          required
        >
        <button class="btn btn-primary" type="submit">업로드</button>
      </div>
      <div class="form-text">
        여러 장 선택 가능 · JPG/PNG/WebP 지원 · 자동 압축 저장
      </div>
    </form>
  </div>

  <!-- 사진 리스트 -->
  <div class="row g-3">
    {% for ph in photos %}
    <div class="col-6 col-sm-4 col-md-3 col-lg-2">
      <div class="card h-100 shadow-sm">
        <a href="{{ ph['url'] }}" target="_blank">
          <img
            src="{{ ph['url'] }}"
            class="card-img-top"
            style="object-fit:cover; aspect-ratio:1/1;"
          >
        </a>
        <div class="card-body p-2">
          <div class="small text-muted text-truncate">{{ ph['filename'] }}</div>
          <form
            method="post"
            action="{{ url_for('register_delete_photo', photo_id=ph['id']) }}"
            onsubmit="return confirm('이 사진을 삭제하시겠습니까?');"
          >
            <button class="btn btn-sm btn-outline-danger w-100 mt-1">
              삭제
            </button>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}

    {% if not photos %}
    <div class="col-12">
      <div class="text-center text-muted py-5">
        등록된 사진이 없습니다.
      </div>
    </div>
    {% endif %}
  </div>
</div>

{% endblock %}
